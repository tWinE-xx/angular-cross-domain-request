!function(e,n){n.module("cdr",[])}(window,window.angular),function(e,n){function t(e,n){function t(e,t){n.register(e,t)}function i(e,n,t,i,o){return r("GET",e,n,t,i,o)}function o(e,n,t,i,o){return r("POST",e,n,t,i,o)}function r(t,i,o,r,s,a){if(null==n.bridge)return a("doRequest: connector not initialized, please run init(bridgePath, callbackFn) function");var u=e.build(i,t,o,r,s);n.postMessage(u,a)}var s={init:t,get:i,post:o};return s}n.module("cdr").service("CdrService",t),t.$inject=["RequestBuilder","IframeManager"]}(window,window.angular),function(e,n){function t(){function n(n,t){var o=l(n),r="connect-iframe-"+o,c=e.document.getElementById(r);if(null!=c)return null==this.bridge&&(this.bridge=c),t(c);e[s](a,i);var d=e.document.createElement("iframe"),g=this;d.onload=function(e,n){return clearTimeout(f),g.bridge=d,u(o),t(d)},d.src=n,d.id=r,d.style="display:none;",e.document.body.appendChild(d);var f=setTimeout(function(){return t(null)},5e3)}function t(n,t){if(null==this.bridge)return t("postMessage: connector not initialized, please run init(bridgePath, callbackFn) function");console&&console.log&&e.http_polyfill_debug&&console.log("client","postMessage",n);var i=c(n.url)+"//"+l(n.url);if(!this.bridge||!this.bridge.contentWindow)return t("postMessage: bridge is not loaded");var o=d();g.add({guid:o,cb:t});var r=c(e.location.toString())+"//"+l(e.location.toString());return this.bridge.contentWindow.postMessage(JSON.stringify({options:n,guid:o,origin:r}),i)}function i(n){var t=JSON.parse(n.data);console&&console.log&&e.http_polyfill_debug&&console.log("client","receiveMessage",t);var i=g.pop("guid",t.guid);i?i.cb(t.result.err,t.result.data):console&&console.log&&console.log("queue missing cb",t)}var o={bridge:null,register:n,postMessage:t,receiveMessage:i},r=e.addEventListener?"addEventListener":"attachEvent",s=e.removeEventListener?"removeEventListener":"detachEvent",a="attachEvent"==r?"onmessage":"message",u=function(n,t){e[r](a,i,!1),console&&console.log&&e.http_polyfill_debug&&console.log("client is listening to ",n)},l=function(e){var n;return n=e.indexOf("://")>-1?e.split("/")[2]:e.split("/")[0]},c=function(e){var n;return n=e.indexOf("://")>-1?e.split("/")[0]:e.split("/")[0]},d=function(){function e(){return Math.floor(65536*(1+Math.random())).toString(16).substring(1)}return e()+e()+"-"+e()+"-"+e()+"-"+e()+"-"+e()+e()+e()},g={state:[],add:function(e){this.state.push(e)},pop:function(e,n){for(var t=0;t<this.state.length;t++)if(this.state[t][e]==n){var i=this.state[t];return this.state.splice(t,1),i}}};return o}n.module("cdr").factory("IframeManager",t),t.$inject=[]}(window,window.angular),function(e,n){function t(){function e(e,n,t,i,o){return{url:e,type:n,headers:o,data:i}}var n={build:e};return n}n.module("cdr",[]).factory("RequestBuilder",t),t.$inject=[]}(window,window.angular);
//# sourceMappingURL=cdr.min.js.map
