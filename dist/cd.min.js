!function(e,t){"use strict";t.module("cdr",[])}(window,window.angular),function(e,t){"use strict";function n(e,t){function n(e,n){t.register(e,n)}function i(e,t,n,i,r){return o("GET",e,t,n,i,r)}function r(e,t,n,i,r){return o("POST",e,t,n,i,r)}function o(n,i,r,o,s,u){if(null==t.bridge)return u("doRequest: connector not initialized, please run init(bridgePath, callbackFn) function");var a=e.build(i,n,r,o,s);t.postMessage(a,u)}var s={init:n,get:i,post:r};return s}t.module("cdr").service("CdrService",n),n.$inject=["RequestBuilder","IframeManager"]}(window,window.angular),function(e,t){"use strict";function n(){function t(t,n){var r=l(t),o="connect-iframe-"+r,c=e.document.getElementById(o);if(null!=c)return null==this.bridge&&(this.bridge=c),n(c);e[s](u,i);var d=e.document.createElement("iframe"),g=this;d.onload=function(e,t){return clearTimeout(f),g.bridge=d,a(r),n(d)},d.src=t,d.id=o,d.style="display:none;",e.document.body.appendChild(d);var f=setTimeout(function(){return n(null)},5e3)}function n(t,n){if(null==this.bridge)return n("postMessage: connector not initialized, please run init(bridgePath, callbackFn) function");console&&console.log&&e.http_polyfill_debug&&console.log("client","postMessage",t);var i=c(t.url)+"//"+l(t.url);if(!this.bridge||!this.bridge.contentWindow)return n("postMessage: bridge is not loaded");var r=d();g.add({guid:r,cb:n});var o=c(e.location.toString())+"//"+l(e.location.toString());return this.bridge.contentWindow.postMessage(JSON.stringify({options:t,guid:r,origin:o}),i)}function i(t){var n=JSON.parse(t.data);console&&console.log&&e.http_polyfill_debug&&console.log("client","receiveMessage",n);var i=g.pop("guid",n.guid);i?i.cb(n.result.err,n.result.data):console&&console.log&&console.log("queue missing cb",n)}var r={bridge:null,register:t,postMessage:n,receiveMessage:i},o=e.addEventListener?"addEventListener":"attachEvent",s=e.removeEventListener?"removeEventListener":"detachEvent",u="attachEvent"==o?"onmessage":"message",a=function(t,n){e[o](u,i,!1),console&&console.log&&e.http_polyfill_debug&&console.log("client is listening to ",t)},l=function(e){var t;return t=e.indexOf("://")>-1?e.split("/")[2]:e.split("/")[0]},c=function(e){var t;return t=e.indexOf("://")>-1?e.split("/")[0]:e.split("/")[0]},d=function(){function e(){return Math.floor(65536*(1+Math.random())).toString(16).substring(1)}return e()+e()+"-"+e()+"-"+e()+"-"+e()+"-"+e()+e()+e()},g={state:[],add:function(e){this.state.push(e)},pop:function(e,t){for(var n=0;n<this.state.length;n++)if(this.state[n][e]==t){var i=this.state[n];return this.state.splice(n,1),i}}};return r}t.module("cdr").factory("IframeManager",n),n.$inject=[]}(window,window.angular),function(e,t){"use strict";function n(){function e(e,t,n,i,r){return{url:e,type:t,headers:r,data:i}}var t={build:e};return t}t.module("cdr",[]).factory("RequestBuilder",n),n.$inject=[]}(window,window.angular);
//# sourceMappingURL=cd.min.js.map
